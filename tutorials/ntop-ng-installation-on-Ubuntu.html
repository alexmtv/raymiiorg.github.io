<!DOCTYPE html><html lang="en"><head><title>ntop-ng 1.1 installation on Ubuntu 12.04 - Raymii.org</title><link href="/s/inc/css/bootstrap.css" rel="stylesheet"/><link href="/s/inc/css/custom.css" rel="stylesheet"/><meta content="text/html;charset=utf-8" http-equiv="Content-Type"/><meta content="IE=edge" http-equiv="X-UA-Compatible"/><link href="inc/img/icons/iphone.png" rel="apple-touch-icon"/><link href="inc/img/icons/ipad.png" rel="apple-touch-icon" sizes="76x76"/><link href="inc/img/icons/iphone-retina.png" rel="apple-touch-icon" sizes="120x120"/><link href="inc/img/icons/ipad-retina.png" rel="apple-touch-icon" sizes="152x152"/><meta content="yes" name="apple-mobile-web-app-capable"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><link href="http://feeds.feedburner.com/Raymiiorg" rel="alternate" title="RSS Feed for Raymii.org" type="application/rss+xml"/></head><body><a id="top-of-page"></a> <div class="container-fluid "><div class="row"><div class="col-md-10 col-md-offset-1"><div class="col-md-3 well"> <h3 class="headheader"><a href="https://raymii.org/s/">Raymii.org</a></h3><h6>Quis custodiet ipsos custodes?</h6><h6><a href="http://feeds.feedburner.com/Raymiiorg">RSS Feed</a></h6></div><div class="col-md-4 green-block"><h3>Featured Items</h3><a class="whitelink" href="/s/tutorials/Ansible_Deployment_Framework.html">Ansible Deployment Framework</a> <br/><a class="whitelink" href="/s/articles/Digital_Ocean_Sucks._Use_Digital_Ocean.html">Digital Ocean Sucks. Use Digital Ocean</a> <br/><a class="whitelink" href="/s/tutorials/Gitlab_and_Active_Directory_LDAP_Authentication.html">Gitlab and Active Directory LDAP Authentication</a> <br/><a class="whitelink" href="/s/articles/Small_Linux_PCs.html">Small Linux PCs</a> <br/><a class="whitelink" href="/s/tutorials/Strong_SSL_Security_On_Apache2.html">Strong SSL Security On Apache2</a> <br/><a class="whitelink" href="/s/tutorials/VMWare-ESXi-5-USB-installer.html">VMWare ESXi 5 USB installer</a> <br/></div><div class="col-md-4 green-block"><h3>Featured Items</h3><a class="whitelink" href="/s/software/Bash_PHP_Server_Status_Monitor.html">Bash PHP Server Status Monitor</a> <br/><a class="whitelink" href="/s/tutorials/IPSEC_L2TP_vpn_with_Ubuntu_12.04.html">IPSEC L2TP vpn with Ubuntu 12.04</a> <br/><a class="whitelink" href="/s/software/Nopriv-IMAP-backup.html">Nopriv IMAP backup</a> <br/><a class="whitelink" href="/s/articles/Set_up_your_own_truly_secure_encrypted_shared_storage_aka_Dropbox_clone.html">Set up your own truly secure encrypted shared storage aka Dropbox clone</a> <br/><a class="whitelink" href="/s/tutorials/Strong_SSL_Security_On_nginx.html">Strong SSL Security On nginx</a> <br/></div></div></div><div class="row-fluid"><div class="col-md-11 col-md-offset-1"><div class="col-md-3"><h3>Menu</h3><ul class="nav nav-pills nav-stacked"><li><a class="link" href="/s/">Home</a> </li><li><a class="link" href="/s/static/Contact.html">Contact</a> </li><li><a class="link" href="/s/static/Disclaimer.html">Disclaimer</a> </li><li><a class="link" href="/s/static/Hosted_Piwik.html">Hosted Piwik</a> </li><li><a class="link" href="/s/static/Sparkling_Network.html">Sparkling Network</a> </li></ul><h3>Categories</h3><ul class="nav nav-pills nav-stacked"><li><a class="link" href="/s/articles">Articles</a> </li><li><a class="link" href="/s/snippets">Snippets</a> </li><li><a class="link" href="/s/software">Software</a> </li><li><a class="link" href="/s/tutorial">Tutorial</a> </li><li><a class="link" href="/s/tutorials">Tutorials</a> </li><li><a class="link" href="/s/everything.html">All Items</a> </li></ul><hr class="alt2"/><h3>Donate</h3><ul><li><a href="http://clients.inceptionhosting.com/aff.php?aff=083">Inception Hosting VPS Affiliate Link</a></li><li><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">Digital Ocean VPS Affiliate</a></li></ul><script id="flattrbtn">(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=Remy&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('flattrbtn');</script><br/><form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top"><input name="cmd" type="hidden" value="_s-xclick"/><input name="encrypted" type="hidden" value="-----BEGIN PKCS7-----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-----END PKCS7-----"/><input alt="PayPal - The safer, easier way to pay online!" name="submit" src="https://www.paypalobjects.com/en_US/NL/i/btn/btn_donateCC_LG.gif" type="image"/><img alt="" border="0" height="1" src="https://www.paypalobjects.com/nl_NL/i/scr/pixel.gif" width="1"/></form><script type="text/javascript"><!--
                google_ad_client = "ca-pub-7993642564731324";
                google_ad_slot = "9322003332";
                google_ad_width = 200;
                google_ad_height = 200;
                //-->
                </script><script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
                </script></div> <div class="col-md-7"> <div class="inner"><h2>ntop-ng 1.1 installation on Ubuntu 12.04</h2><ul class="breadcrumb"><li><a class="link" href="../">Home</a> <col-md- class="divider">/</col-md-></li><li><a class="link" href="../tutorials">Tutorials</a> <col-md- class="divider">/</col-md-></li><li><a class="link" href="ntop-ng-installation-on-Ubuntu.html">ntop-ng 1.1 installation on Ubuntu 12.04</a> </li></ul><h6>Author: Remy Van Elst</h6><h6>Date: 29-11-2013</h6><br/><p><a href="https://raymii.org/s/inc/img/ntopng/1.png"><img alt="ntop" src="https://raymii.org/s/inc/img/ntopng/1.png"/></a></p><p>This is a guide on installing the latest ntop-ng (1.1) on Ubuntu 12.04. </p><pre><code>ntopng is the next generation version of the original ntop, a network traffic probe that shows the network usage, similar to what the popular top Unix command does. ntop is based on libpcap and it has been written in a portable way in order to virtually run on every Unix platform, MacOSX and on Win32 as well. ntopng users can use a a web browser to navigate through ntop (that acts as a web server) traffic information and get a dump of the network status. In the latter case, ntop can be seen as a simple RMON-like agent with an embedded web interface. 
</code></pre><p>This tutorial will walk you through the compilation and installation of ntopng from source. The package in the Ubuntu 12.04 repositories it quite old.</p><h3>What can ntopng do?</h3><ul><li>Sort network traffic according to many protocols</li><li>Show network traffic and IPv4/v6 active hosts</li><li>Store on disk persistent traffic statistics in RRD format</li><li>Geolocate hosts</li><li>Discover application protocols by leveraging on nDPI, ntops DPI framework.</li><li>Characterise HTTP traffic by leveraging on characterisation services provided by block.si. </li><li>Show IP traffic distribution among the various protocols</li><li>Analyse IP traffic and sort it according to the source/destination</li><li>Display IP Traffic Subnet matrix (whos talking to who?)</li><li>Report IP protocol usage sorted by protocol type</li><li>Act as a NetFlow/sFlow collector for flows generated by routers (e.g. Cisco and Juniper) or switches (e.g. Foundry Networks) when used together with nProbe.</li><li>Produce HTML5/AJAX network traffic statistics</li></ul><p><a href="http://www.ntop.org/">More information on ntop-ng can be found on their website: http://www.ntop.org/</a></p><p><a href="https://raymii.org/s/inc/img/ntopng/2.png"><img alt="ntop" src="https://raymii.org/s/inc/img/ntopng/2.png"/></a></p><h3>Contents</h3><p>This is what we are going to do:</p><ul><li>Install required packages</li><li>Download files</li><li>Place ntopng-data</li><li>Compile ntopng</li><li>Create config file</li><li>Test ntopng</li><li>Place upstart script</li></ul><p>Here's what you need:</p><ul><li>Ubuntu 12.04 installation</li><li>Debian 7 also works</li></ul><p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">This tutorial was written and tested on a DigitalOcean VPS. If you use this you sponsor me (referral link)</a></p><h3>Installing required packages</h3><p>These are the packages we need to build and use for ntopng</p><pre><code> apt-get install libpcap-dev libglib2.0-dev libgeoip-dev redis-server wget libxml2-dev build-essential
</code></pre><p><a href="https://raymii.org/s/inc/img/ntopng/3.png"><img alt="ntop" src="https://raymii.org/s/inc/img/ntopng/3.png"/></a></p><h3>Download the files</h3><p>We need to download both the data files and the source code. You can download it <a href="http://sourceforge.net/projects/ntop/files/ntopng/">from sourceforge</a>:</p><pre><code>mkdir -p /usr/local/src
cd /usr/local/src

wget "http://downloads.sourceforge.net/project/ntop/ntopng/ntopng-data-1.1_6932.tgz" -O ntopng-data-1.1.tar.gz

wget "http://downloads.sourceforge.net/project/ntop/ntopng/ntopng-1.1_6932.tgz" -O ntopng-1.1.tar.gz
</code></pre><h3>Place ntopng-data</h3><p>The data files contain files for the web interface like the GeoIP database. They are already good, the only thing we need to do is place them:</p><pre><code>cd /usr/local/src
tar -xf ntopng-data-1.1.tar.gz
cd ntopng-data-1.1_6932
cp -r ./usr/* /usr 
</code></pre><h3>Compile ntopng</h3><p>The compilation of ntopng itself is a bit more work, this is because the ntopng 1.1 package includes prebuilt .o blobs for third party tools, probably by accident, which will cause you trouble when building ntopng yourself. We need to clean those up.</p><p>First we extract: </p><pre><code>cd /usr/local/src
tar -xf ntopng-1.1.tar.gz
cd ntopng-1.1_6932
</code></pre><p>Then we configure:</p><pre><code>./configure
</code></pre><p>Clean up:</p><pre><code>make clean

cd third-party/json-c 
make clean
cd .. 

cd third-party/LuaJIT-2.0.2
make clean
cd .. 

cd third-party/rrdtool-1.4.7
make clean
cd ..

cd third-party/zeromq-3.2.3
make clean
cd ..

cd third-party/credis-0.2.3
make clean
cd ..
</code></pre><p>Start the actual compilation:</p><pre><code>make
</code></pre><p>And install the thing:</p><pre><code>make install
</code></pre><p><a href="https://raymii.org/s/inc/img/ntopng/4.png"><img alt="ntop" src="https://raymii.org/s/inc/img/ntopng/4.png"/></a></p><h3>Creating the ntopng config file</h3><p>First we create the required folder:</p><pre><code>mkdir -p /etc/ntopng
</code></pre><p>There are two files needed. First is <code>/etc/ntopng/ntopng.start</code>:</p><pre><code>--local-networks "172.20.16.0/24"
--interface 1
</code></pre><p>To see all available interfaces and options, use the <code>ntopng -h</code> option:</p><pre><code>Available interfaces (-i <interface index>):
   1. eth0
   2. vmbr0
   3. venet0
   [...]
   14. any
   15. lo
</code></pre><p>Then there is the <code>/etc/ntopng/ntopng.conf</code> file:</p><pre><code>-G=/var/run/ntopng.pid
</code></pre><p>Again, with the <code>ntopng -</code> option you can see all the possible options for use in this config file.</p><p>Before starting the test, make sure redis is started:</p><pre><code>/etc/init.d/redis-server restart
</code></pre><h3>Test ntopng</h3><p>If the compilation gave no errors and the config files are places we can start <code>ntopng</code> and see how it works:</p><pre><code>ntopng /etc/ntopng/ntopng.conf
</code></pre><p>Use your web browser to navigate to <code>http://your-ntop-box-ip:3000</code>. There you can login with the username/password combo <code>admin/admin</code>.</p><p>If this works, and there is data visible as in the screenshots, continue on to set up the upstart script.</p><p><a href="https://raymii.org/s/inc/img/ntopng/5.png"><img alt="ntop" src="https://raymii.org/s/inc/img/ntopng/5.png"/></a></p><h3>Upstart script</h3><p>This is a simple upstart script which can be used to start, stop and restart ntopng. Place it in <code>/etc/init/ntopng.conf</code>:</p><pre><code># ntopng network flow analyzer
# by https://raymii.org

description     "ntopng network flow analyzer"

start on virtual-filesystems
stop on runlevel [06]

respawn
respawn limit 5 30
limit nofile 65550 65550

setuid root
setgid root
console log

script
        exec /usr/local/bin/ntopng /etc/ntopng/ntopng.conf
end script
</code></pre><hr/> Tags: <a class="link" href="../tags/apache.html">apache, </a> <a class="link" href="../tags/lua.html">lua, </a> <a class="link" href="../tags/monitoring.html">monitoring, </a> <a class="link" href="../tags/network.html">network, </a> <a class="link" href="../tags/ntop.html">ntop, </a> <a class="link" href="../tags/ntop-ng.html">ntop-ng, </a> <a class="link" href="../tags/ubuntu.html">ubuntu, </a> <div class="footer"><hr/><br/><hr/><p>Generated by <a href="https://raymii.org/s/software/ingsoc.html">ingsoc</a>.<br/></p></div></div></div></div> </div></div><script type="text/javascript">
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://hosted-oswa.org/piwik/" : "http://hosted-oswa.org/piwik/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
    </script><script type="text/javascript">
    try {
    var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
    piwikTracker.trackPageView();
    piwikTracker.enableLinkTracking();
    } catch( err ) {}
    </script><noscript>&amp;lt;p&amp;gt;&amp;lt;img src="http://hosted-oswa.org/piwik/piwik.php?idsite=1" style="border:0" alt="" /&amp;gt;&amp;lt;/p&amp;gt;</noscript></body></html>