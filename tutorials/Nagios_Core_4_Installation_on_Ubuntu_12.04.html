<!DOCTYPE html><html lang="en"><head><title>Nagios Core 4.0.2 installation on Ubuntu 12.04 - Raymii.org</title><link href="/s/inc/css/bootstrap.css" rel="stylesheet"/><link href="/s/inc/css/custom.css" rel="stylesheet"/><meta content="text/html;charset=utf-8" http-equiv="Content-Type"/><meta content="IE=edge" http-equiv="X-UA-Compatible"/><link href="inc/img/icons/iphone.png" rel="apple-touch-icon"/><link href="inc/img/icons/ipad.png" rel="apple-touch-icon" sizes="76x76"/><link href="inc/img/icons/iphone-retina.png" rel="apple-touch-icon" sizes="120x120"/><link href="inc/img/icons/ipad-retina.png" rel="apple-touch-icon" sizes="152x152"/><meta content="yes" name="apple-mobile-web-app-capable"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><link href="http://feeds.feedburner.com/Raymiiorg" rel="alternate" title="RSS Feed for Raymii.org" type="application/rss+xml"/></head><body><a id="top-of-page"></a> <div class="container-fluid "><div class="row"><div class="col-md-10 col-md-offset-1"><div class="col-md-3 well"> <h3 class="headheader"><a href="https://raymii.org/s/">Raymii.org</a></h3><h6>Quis custodiet ipsos custodes?</h6><h6><a href="http://feeds.feedburner.com/Raymiiorg">RSS Feed</a></h6></div><div class="col-md-4 green-block"><h3>Featured Items</h3><a class="whitelink" href="/s/tutorials/Ansible_Deployment_Framework.html">Ansible Deployment Framework</a> <br/><a class="whitelink" href="/s/articles/Digital_Ocean_Sucks._Use_Digital_Ocean.html">Digital Ocean Sucks. Use Digital Ocean</a> <br/><a class="whitelink" href="/s/tutorials/Gitlab_and_Active_Directory_LDAP_Authentication.html">Gitlab and Active Directory LDAP Authentication</a> <br/><a class="whitelink" href="/s/articles/Small_Linux_PCs.html">Small Linux PCs</a> <br/><a class="whitelink" href="/s/tutorials/Strong_SSL_Security_On_Apache2.html">Strong SSL Security On Apache2</a> <br/><a class="whitelink" href="/s/tutorials/VMWare-ESXi-5-USB-installer.html">VMWare ESXi 5 USB installer</a> <br/></div><div class="col-md-4 green-block"><h3>Featured Items</h3><a class="whitelink" href="/s/software/Bash_PHP_Server_Status_Monitor.html">Bash PHP Server Status Monitor</a> <br/><a class="whitelink" href="/s/tutorials/Collectd_server_setup_tutorial_with_web_frontend.html">Collectd server setup tutorial with web frontend</a> <br/><a class="whitelink" href="/s/tutorials/IPSEC_L2TP_vpn_with_Ubuntu_12.04.html">IPSEC L2TP vpn with Ubuntu 12.04</a> <br/><a class="whitelink" href="/s/software/Nopriv-IMAP-backup.html">Nopriv IMAP backup</a> <br/><a class="whitelink" href="/s/articles/Set_up_your_own_truly_secure_encrypted_shared_storage_aka_Dropbox_clone.html">Set up your own truly secure encrypted shared storage aka Dropbox clone</a> <br/><a class="whitelink" href="/s/tutorials/Strong_SSL_Security_On_nginx.html">Strong SSL Security On nginx</a> <br/></div></div></div><div class="row-fluid"><div class="col-md-11 col-md-offset-1"><div class="col-md-3"><h3>Menu</h3><ul class="nav nav-pills nav-stacked"><li><a class="link" href="/s/">Home</a> </li><li><a class="link" href="/s/static/Contact.html">Contact</a> </li><li><a class="link" href="/s/static/Disclaimer.html">Disclaimer</a> </li><li><a class="link" href="/s/static/Hosted_Piwik.html">Hosted Piwik</a> </li><li><a class="link" href="/s/static/Sparkling_Network.html">Sparkling Network</a> </li></ul><h3>Categories</h3><ul class="nav nav-pills nav-stacked"><li><a class="link" href="/s/articles">Articles</a> </li><li><a class="link" href="/s/snippets">Snippets</a> </li><li><a class="link" href="/s/software">Software</a> </li><li><a class="link" href="/s/tutorial">Tutorial</a> </li><li><a class="link" href="/s/tutorials">Tutorials</a> </li><li><a class="link" href="/s/everything.html">All Items</a></li><a class="link" href="/s/everything.html"></a> </ul><hr class="alt2"/><h3>Donate</h3><ul><li><a href="http://clients.inceptionhosting.com/aff.php?aff=083">Inception Hosting VPS Affiliate Link</a></li><li><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">Digital Ocean VPS Affiliate</a></li></ul><script id="flattrbtn">(function(i){var f,s=document.getElementById(i);f=document.createElement('iframe');f.src='//api.flattr.com/button/view/?uid=Remy&url='+encodeURIComponent(document.URL);f.title='Flattr';f.height=62;f.width=55;f.style.borderWidth=0;s.parentNode.insertBefore(f,s);})('flattrbtn');</script><br/><form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top"><input name="cmd" type="hidden" value="_s-xclick"/><input name="encrypted" type="hidden" value="-----BEGIN PKCS7-----MIIHLwYJKoZIhvcNAQcEoIIHIDCCBxwCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYB1lOyoMm13xLpyJ06VTAajIRPFl46+yfqSnLQLu1lFfVKmhLtM0Ql+JSnH+LzVuhHLTzXegaPClXjMvhTpp0byApM4YlCi1czJKxBGb2+qw6il53H1g7L1qlfm95Jd80s80C9r+b3ituTXuYhb4Eb7PQ6Cyy6ca9raUgYVv90pETELMAkGBSsOAwIaBQAwgawGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIS23AJUhGuB6AgYhcWUVn4DMqTx2Ai2Ql9TQjkiAC3tXScmjpq/10b0P6DTIIg5OSPIly9C2gLMEcMCZ8aNuLT3kp+2Hn+nDuzsdY/4QU8zOFC4STyDrAn1gqe8q4pPGADqE0KUiWRAJR8eTx9paclkiaxDicr3D0uF409IRLIe/v1S6ZV9JOlQk5Xys9cRfAuhTioIIDhzCCA4MwggLsoAMCAQICAQAwDQYJKoZIhvcNAQEFBQAwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tMB4XDTA0MDIxMzEwMTMxNVoXDTM1MDIxMzEwMTMxNVowgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDBR07d/ETMS1ycjtkpkvjXZe9k+6CieLuLsPumsJ7QC1odNz3sJiCbs2wC0nLE0uLGaEtXynIgRqIddYCHx88pb5HTXv4SZeuv0Rqq4+axW9PLAAATU8w04qqjaSXgbGLP3NmohqM6bV9kZZwZLR/klDaQGo1u9uDb9lr4Yn+rBQIDAQABo4HuMIHrMB0GA1UdDgQWBBSWn3y7xm8XvVk/UtcKG+wQ1mSUazCBuwYDVR0jBIGzMIGwgBSWn3y7xm8XvVk/UtcKG+wQ1mSUa6GBlKSBkTCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb22CAQAwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOBgQCBXzpWmoBa5e9fo6ujionW1hUhPkOBakTr3YCDjbYfvJEiv/2P+IobhOGJr85+XHhN0v4gUkEDI8r2/rNk1m0GA8HKddvTjyGw/XqXa+LSTlDYkqI8OwR8GEYj4efEtcRpRYBxV8KxAW93YDWzFGvruKnnLbDAF6VR5w/cCMn5hzGCAZowggGWAgEBMIGUMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbQIBADAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTMwODAzMTQxNTQ2WjAjBgkqhkiG9w0BCQQxFgQUhdv5C5Xqr+zLV4qAlrYYqFV/fgYwDQYJKoZIhvcNAQEBBQAEgYBaGzom1dMP+CEmGQIZfP6ynZyRIc+4uQuvKoeRlkHwOj9F4c8QqXwBq/fyMogtZ/iES1oTifarxzQ3gesy/dSSs+IxG6YLICQXsAWNVnYL7u9of1xcCyJh3QoH/elgrjdHw0KCeBWNZPlbzEKSwTJ08yBsuKFR8zSqz8pIjC6XrQ==-----END PKCS7-----"/><input alt="PayPal - The safer, easier way to pay online!" border="0" name="submit" src="https://www.paypalobjects.com/en_US/NL/i/btn/btn_donateCC_LG.gif" type="image"/><img alt="" border="0" height="1" src="https://www.paypalobjects.com/nl_NL/i/scr/pixel.gif" width="1"/></form><script type="text/javascript"><!--
                google_ad_client = "ca-pub-7993642564731324";
                google_ad_slot = "9322003332";
                google_ad_width = 200;
                google_ad_height = 200;
                //-->
                </script><script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
                </script></div> <div class="col-md-7"> <div class="inner"><h2>Nagios Core 4.0.2 installation on Ubuntu 12.04</h2><ul class="breadcrumb"><li><a class="link" href="../">Home</a> <col-md- class="divider">/</col-md-></li><li><a class="link" href="../tutorials">Tutorials</a> <col-md- class="divider">/</col-md-></li><li><a class="link" href="Nagios_Core_4_Installation_on_Ubuntu_12.04.html">Nagios Core 4.0.2 installation on Ubuntu 12.04</a> </li></ul><h6>Author: Remy Van Elst</h6><h6>Date: 24-11-2013</h6><br/><p><img alt="nagios 4" src="https://raymii.org/s/inc/img/nagios4.png"/></p><p>This is a guide on installing the latest Nagios Core (4.0.2) on Ubuntu 12.04. Nagios is an open source computer system monitoring, network monitoring and infrastructure monitoring software application. Nagios offers monitoring and alerting services for servers, switches, applications, and services. It alerts the users when things go wrong and alerts them a second time when the problem has been resolved. The version in the Ubuntu repositories is quite old, it is still the in the 3 branch. This guide helps to fix that by using the latest Nagios version.</p><p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">This tutorial was written and tested on a DigitalOcean VPS. If you use this you sponsor me (referral link)</a></p><p>You can find more information about Nagios on the official website: <a href="http://www.nagios.org/projects/nagioscore">http://www.nagios.org/projects/nagioscore</a>.</p><p>The description of Nagios Core from their website:</p><pre><code>Nagios Core is the monitoring and alerting engine that serves as the primary application around which hundreds of Nagios projects are built. It serves as the basic event scheduler, event processor, and alert manager for elements that are monitored. It features several APIs that are used to extend its capabilities to perform additional tasks, is implemented as a daemon written in C for performance reasons, and is designed to run natively on Linux/*nix systems.
</code></pre><h3>Contents</h3><p>We are going to do the following:</p><ul><li>Install required packages</li><li>Create the Nagios user</li><li>Download and Compile Nagios Core</li><li>Download and Compile the Nagios Plugins</li><li>Download and Compile NRPE</li><li>Setup the upstart script</li><li>Set up Apache</li></ul><p>At the end of this tutorial you will have a fully up to date Nagios Core installation, with the latest plugins, the latest NRPE and the webinterface set up with authentication and ssl. </p><p>This was written and tested on Ubuntu 12.04, both 32 and 64 bit.</p><h3>Whats new in Nagios Core 4?</h3><p><strong>Major performance increaces</strong>: </p><ul><li>Core Workers - Core workers are lightweight processes whose only job is to perform checks. Because they are smaller they spawn much more quickly than the the old process which forked the full Nagios Core. In addition, they communicate with the main Nagios Core process using in-memory techniques, eliminating the disk I/O latencies that could previously slow things down, especially in large installations.</li><li>Configuration Verification - Configuration verification has been improved so that each configuration item is verified only once. Previously configuration verification was an O(n2) operation.</li><li>Event Queue - The event queue now uses a data structure that has O(log n) insertion times versus the O(n) insertion time previously. This means that inserting events into the queue uses much less CPU than in Nagios Core 3. </li></ul><p><strong>Other nice changes</strong>:<br/> - The host address attribute is now optional. The address attribute is set to the host name when it is absent. Most configurations set the host name attribute to the DNS host name making the address attribute redundant. - Both hosts and services now support an hourly value attribute. The hourly value attribute is intended to represent the value of a host or service to an organization and is used by the new minimum value contact attribute.- Services now support a parents attribute. A service parent performs a function similar to host parents and can be used in place of service dependencies in simple circumstances.</p><p><strong>No more embedded perl</strong>:<br/>- Embedded Perl - Embedded Perl has historically been the least tested and the most problem prone part of Nagios Core. A significant part of the issue is that there are so many versions of Perl available. The performance enhancements provided by the new worker process architecture make up for any performance loss due to the removal of embeddd Perl. In addition, the worker process architecture makes possible the implementation of a special purpose worker to persistently load and run Perl plugins. The following configuration variables that were related to embedded Perl have been obsoleted: use<em>embedded</em>perl<em>implicitly, enable</em>embedded<em>perl, p1</em>file. - This means my ESXi checks do not work anymore...</p><p><a href="http://nagios.sourceforge.net/docs/nagioscore/4/en/whatsnew.html">See this page for the full listing of new stuff in Nagios 4: http://nagios.sourceforge.net/docs/nagioscore/4/en/whatsnew.html</a></p><h3>Note about currently installed Nagios versions</h3><p>Make sure you remove all currently installed Nagios versions and packages. Better yet, start on a new empty server/vm.</p><h3>Note about the plugins and NRPE</h3><p>We are compiling the latest version of the plugins and NRPE on the Nagios Server. On the Nagios clients, you <strong>do not have to do this</strong>. The version of NRPE in the Ubuntu repositories works with this newer Nagios version. The same goes for the plugins.</p><h3>Install required packages</h3><p>Install the packages required for compilation, apache and mail functionality:</p><pre><code>apt-get install apache2 libapache2-mod-php5 build-essential libgd2-xpm-dev libssl-dev sendmail-bin sendmail heirloom-mailx wget curl daemon apt-file libnet-snmp-perl libperl5.14 libpq5 libradius1 libsensors4 libsnmp-base libsnmp15 libtalloc2 libtdb1 libwbclient0 samba-common samba-common-bin smbclient snmp whois libmysqlclient15-dev
</code></pre><h3>Create the Nagios user</h3><p>Nagios runs as its own user and has its own groups. We need to create this user and groups. We also make sure the user Apache runs as can access the Nagios files by adding the www-data user to the nagios groups.</p><pre><code>groupadd -g 3000 nagios
groupadd -g 3001 nagcmd
useradd -u 3000 -g nagios -G nagcmd -d /usr/local/nagios -c 'Nagios Admin' nagios
adduser www-data nagcmd
</code></pre><h3>Download and Compile Nagios Core</h3><p>If necessary, create <code>/usr/local/src/nagios4</code>:</p><pre><code>mkdir -p /usr/local/src/nagios4
</code></pre><p>cd into <code>/usr/local/src/nagios4</code>:</p><pre><code>cd /usr/local/src/nagios4
</code></pre><p>(I like to keep my source code and compilation files in one place).</p><p>Use wget to download the latest Nagios Core from sourceforge:</p><pre><code>wget http://prdownloads.sourceforge.net/sourceforge/nagios/nagios-4.0.2.tar.gz
</code></pre><p>Extract it:</p><pre><code>tar xf nagios-4.0.2.tar.gz
cd nagios-4.0.2
</code></pre><p>Create a few folders:</p><pre><code>mkdir -p /usr/local/nagios/share/{stylesheets,images}
</code></pre><p>Now start the compilation process. First configure:</p><pre><code>./configure --prefix=/usr/local/nagios --with-nagios-user=nagios --with-nagios-group=nagios --with-command-user=nagios --with-command-group=nagcmd
</code></pre><p>Output should look like this:</p><pre><code> General Options:
 -------------------------
        Nagios executable:  nagios
        Nagios user/group:  nagios,nagios
       Command user/group:  nagios,nagcmd
             Event Broker:  yes
        Install ${prefix}:  /usr/local/nagios
    Install ${includedir}:  /usr/local/nagios/include/nagios
                Lock file:  ${prefix}/var/nagios.lock
   Check result directory:  ${prefix}/var/spool/checkresults
           Init directory:  /etc/init.d
  Apache conf.d directory:  /etc/apache2/conf.d
             Mail program:  /usr/bin/mail
                  Host OS:  linux-gnu

 Web Interface Options:
 ------------------------
                 HTML URL:  http://localhost/nagios/
                  CGI URL:  http://localhost/nagios/cgi-bin/
 Traceroute (used by WAP):  /usr/sbin/traceroute


Review the options above for accuracy.  If they look okay,
type 'make all' to compile the main program and CGIs.
</code></pre><p>Then the make process:</p><pre><code>make all
</code></pre><p>Then the make install, for all the parts:</p><pre><code># This installs the main program, CGIs, and HTML files
make install

# This installs the init script in /etc/init.d
make install-init

# This installs *SAMPLE* config files in /usr/local/nagios/etc
make install-config

#This installs and configures permissions on the directory for holding the external command file
make install-commandmode

# This installs the Apache config file for the Nagios web interface
make install-webconf

# This installs the Exfoliation theme for the Nagios web interface
make install-exfoliation
</code></pre><p>If this all goes well, we can continue to the next part.</p><h3>Download and Compile the Nagios Plugins</h3><p>Same as above. First create the right folders:</p><pre><code>mkdir -p /usr/local/src/nagios-plugins
cd /usr/local/src/nagios-plugins
</code></pre><p>Download the files and untar them:</p><pre><code>wget https://www.nagios-plugins.org/download/nagios-plugins-1.5.tar.gz
tar -xf nagios-plugins-1.5.tar.gz
cd nagios-plugins-1.5
</code></pre><p>Start the compile process:</p><pre><code>./configure --with-nagios-user=nagios --with-nagios-group=nagios --with-openssl=/usr/bin/openssl --enable-perl-modules --enable-libtap
</code></pre><p>Then the make and make install:</p><pre><code>make
make install
</code></pre><p>This should also go fine. Continue on to NRPE.</p><h3>Download and Compile NRPE</h3><pre><code>NRPE allows you to remotely execute Nagios plugins on other Linux/Unix machines. This allows you to monitor remote machine metrics (disk usage, CPU load, etc.). NRPE can also communicate with some of the Windows agent addons, so you can execute scripts and check metrics on remote Windows machines as well.
</code></pre><p>Same steps as above. First create the right folders:</p><pre><code>mkdir -p /usr/local/src/nrpe
cd /usr/local/src/nrpe
</code></pre><p>Download the files and extract:</p><pre><code>wget http://kent.dl.sourceforge.net/project/nagios/nrpe-2.x/nrpe-2.15/nrpe-2.15.tar.gz
tar -xf nrpe-2.15.tar.gz
cd nrpe-2.15
</code></pre><p>Because of <a href="http://askubuntu.com/questions/133184/nagios-nrpe-installation-errorconfigure-error-cannot-find-ssl-libraries">an issue with the openssl library folder</a> we need to use another path than <code>/usr/lib</code>:</p><pre><code>./configure --with-ssl=/usr/bin/openssl --with-ssl-lib=/usr/lib/x86_64-linux-gnu
</code></pre><p>(If you run a 32 bit installation of Ubuntu you can find the right path using this command: <code>apt-file search libssl | grep libssl-dev</code>. You might need to install <code>apt-file</code>.)</p><p>Now make and make install:</p><pre><code>make all
make install
</code></pre><p>That part also finished. Continue on.</p><h3>Setup the upstart script</h3><p>The current init script which comes with Nagios Core 4.0.2 does not work with Ubuntu 12.04. See this stackoverflow topic: <a href="http://stackoverflow.com/questions/19606049/nagios-4-cant-open-etc-rc-d-init-d-functions">http://stackoverflow.com/questions/19606049/nagios-4-cant-open-etc-rc-d-init-d-functions</a>. </p><p>The fixes in that topic and on the Nagios forum did not work for me, so I wrote a very simple upstart script. </p><p>Place it in <code>/etc/init/nagios.conf</code>:</p><pre><code># nagios - monitoriong system
# by https://raymii.org

description     "nagios monitoring system"

start on virtual-filesystems
stop on runlevel [06]

respawn
respawn limit 5 30
limit nofile 65550 65550

chdir /usr/local/nagios/
setuid nagios
setgid nagios
console log

script
        exec bin/nagios etc/nagios.cfg
end script
</code></pre><p>Don't forget to remove the init script:</p><pre><code>mv /etc/init.d/nagios /var/backup/nagios.init
</code></pre><h3>Set up Apache</h3><p>First we set up a user account for the new nagios user:</p><pre><code>htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin
chown nagios:nagcmd /usr/local/nagios/etc/htpasswd.users
</code></pre><p>Then we create a certificate. This is a self signed one, you can also request a certificate at a provider such as Digicert or Verisign.</p><pre><code>mkdir /etc/apache2/ssl
cd /etc/apache2/ssl
a2enmod ssl
openssl req -x509 -nodes -days 365 -newkey rsa:4096 -out nagios.pem -keyout nagios.key
</code></pre><p>We also create a folder for nagios under <code>/var/www</code>:</p><pre><code>mkdir -p /var/www/nagios4/
chown www-data:www-data /var/www/nagios4
</code></pre><p>Create some symlinks:</p><pre><code>ln -s /usr/local/src/nagios4/nagios-4.0.2/contrib/exfoliation/images/favicon.ico /var/www/favicon.ico
</code></pre><p>Set up a vhost for Nagios. The below file can be used. Place it in <code>/etc/apache2/sites-available/nagios</code>:</p><pre><code>&lt;VirtualHost *:443&gt;
    ServerAdmin webmaster@example.org
    ServerName nagios.example.org
    DocumentRoot /var/www/nagios

    &lt;Directory /&gt;
        Options FollowSymLinks
        AllowOverride None
    &lt;/Directory&gt;

    &lt;Directory /var/www/nagios&gt;
        Options -Indexes FollowSymLinks MultiViews
        AllowOverride All
        Order allow,deny
        allow from all
    &lt;/Directory&gt;

     SSLEngine On
     SSLCertificateFile /etc/apache2/ssl/nagios.pem
     SSLCertificateKeyFile /etc/apache2/ssl/nagios.key
&lt;/VirtualHost&gt;
</code></pre><p>Remember to replace <code>example.org</code> with your domain.</p><p>Disable the default vhost:</p><pre><code>a2dissite default
</code></pre><p>Enable the vhost:</p><pre><code>a2ensite nagios
</code></pre><p>Restart apache:</p><pre><code>/etc/init.d/apache2 restart
</code></pre><p>Now we are finished with the installation. Read on for some tweaks I like to make.</p><h3>Tweaks</h3><p>I like to have my config files in <code>/etc/nagios/conf.d</code>. To do that, we create a symlink first:</p><pre><code>ln -s /usr/local/nagios/etc /etc/nagios
</code></pre><p>Then the <code>conf.d</code> folder:</p><pre><code>mkdir /etc/nagios/conf.d
</code></pre><p>Then add this to <code>/etc/nagios/nagios.cfg</code></p><pre><code>cfg_dir=/etc/nagios/conf.d/
</code></pre><p>I also like to seperate my config in directories like so:</p><p><a href="http://gnuworldorder.info/shownotes/lstree.txt">lstree</a></p><pre><code>/etc/nagios/conf.d
   .
   |-contacts
   |-hostgroups
   |-hosts
   |-servicegroups
   |-services
   |-templates
   |-timeperiods
</code></pre><p>Create it like this:</p><pre><code>mkdir -p /etc/nagios/conf.d/{hosts,services,timeperiods,templates,hostgroups,servicegroups,contacts}
</code></pre><p>Remember to restart Nagios when you are finished:</p><pre><code>service nagios restart
</code></pre><p>And the nagios is accessible at https://example.org/nagios, with username <code>nagiosadmin</code> and your chosen password.</p><hr/>Tags: <a class="link" href="../tags/apache.html">apache, </a> <a class="link" href="../tags/monitoring.html">monitoring, </a> <a class="link" href="../tags/nagios.html">nagios, </a> <a class="link" href="../tags/nagios-core.html">nagios-core, </a> <a class="link" href="../tags/nrpe.html">nrpe, </a> <a class="link" href="../tags/ubuntu.html">ubuntu, </a> <div class="footer"><hr/><br/><hr/><p>Generated by <a href="https://raymii.org/s/software/ingsoc.html">ingsoc</a>.<br/></p></div></div></div></div> </div></div><script type="text/javascript">
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://hosted-oswa.org/piwik/" : "http://hosted-oswa.org/piwik/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
    </script><script type="text/javascript">
    try {
    var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
    piwikTracker.trackPageView();
    piwikTracker.enableLinkTracking();
    } catch( err ) {}
    </script><noscript>&amp;lt;p&amp;gt;&amp;lt;img src="http://hosted-oswa.org/piwik/piwik.php?idsite=1" style="border:0" alt="" /&amp;gt;&amp;lt;/p&amp;gt;</noscript></body></html>