
    <!DOCTYPE html>
    <html lang="en">
        <head>
        <title>Raspberry Pi FM radio transmitter with Buttons - Raymii.org</title>
        <link href="/s/inc/css/custom-first.css" rel="stylesheet" />
        <link href="/s/inc/css/light.css" rel="stylesheet"  />
        <link href="/s/inc/css/custom.css" rel="stylesheet" title="custom" />
        <script src="/s//inc/js/toc.js" type="text/javascript"></script>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <link href="inc/img/icons/iphone.png" rel="apple-touch-icon" />
        <link href="inc/img/icons/ipad.png" rel="apple-touch-icon" sizes="76x76" />
        <link href="inc/img/icons/iphone-retina.png" rel="apple-touch-icon" sizes="120x120" />
        <link href="inc/img/icons/ipad-retina.png" rel="apple-touch-icon" sizes="152x152" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="application/opensearchdescription+xml" rel="search" href="/s/inc/opensearch.xml"/>
        <link rel="alternate" type="application/rss+xml" title="RSS Feed for Raymii.org" href="https://raymii.org/s/feed.xml" />
    </head>
    <body>
        <a id="top-of-page"></a>
        <div class="container-fluid ">
            <div class="row">
                <div class="col-md-12">
                    <div class="col-md-3 col-sm-3 max-200">
                        <div class="well well-none"> 
                            <h3 class="headheader"><a href="https://raymii.org/s/">Raymii.org <img src="/s/inc/img/resistor-50.png" alt="IEC Resistor logo"></a></h3>
                            <h6 class="headheader">Quis custodiet ipsos custodes?</h6>
                            <h6><a href="https://raymii.org/s/feed.xml">RSS Feed</a></h6>
                        </div>
          

    
    <form role="search" action="https://encrypted.google.com/search">
        <div class="form-group">
          <input type="hidden" name="as_sitesearch" value="raymii.org">
          <input type="hidden" name="as_qdr" value="all">
          <input type="text" name="as_q" class="form-control" placeholder="Search">
        </div>
      </form>
      <div class="menu"><ul class="nav nav-pills nav-stacked"><li><a href="/s/index.html" class="special-menu">Home</a></li><li class='bottom-spacing'><a href="/s/everything.html" class="special-menu">All Pages</a></li><li class='hideifsmall'><a href="/s/tags/bash.html" class="link">Bash</a></li><li class='hideifsmall'><a href="/s/tags/monitoring.html" class="link">Monitoring</a></li><li class='hideifsmall'><a href="/s/tags/ssl.html" class="link">SSL</a></li><li class='hideifsmall'><a href="/s/tags/debian.html" class="link">Debian</a></li><li class='hideifsmall'><a href="/s/tags/python.html" class="link">Python</a></li><li class='hideifsmall'><a href="/s/tags/vpn.html" class="link">VPN</a></li><li class='hideifsmall'><a href="/s/tags/ubuntu.html" class="link">Ubuntu</a></li><li class='hideifsmall'><a href="/s/tags/nginx.html" class="link">nginx</a></li><li class='hideifsmall'><a href="/s/tags/openstack.html" class="link">Openstack</a></li><li class='hideifsmall'><a href="/s/tags/ansible.html" class="link">Ansible</a></li></ul>            
               <!-- advertisement start -->
                <a href="http://clients.inceptionhosting.com/aff.php?aff=083">Inception Hosting Affiliate Link</a><br />
                <a href="https://www.digitalocean.com/?refcode=7435ae6b8212">Digital Ocean Affiliate Link, $10 free credit.</a><br />
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- Raymii-2 -->
                <ins class="adsbygoogle"
                     style="display:inline-block;width:200px;height:200px"
                     data-ad-client="ca-pub-7993642564731324"
                     data-ad-slot="9322003332"></ins>
                <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                <!-- advertisement end -->
                </div>
           </div>  
           <div class="col-md-8 col-sm-8"> 
                <div class="inner">

           <h2 class='headheader'>Raspberry Pi FM radio transmitter with Buttons</h2><ul class="breadcrumb"><li><a href="../index.html" class="link">Home</a></li><li><a href="../articles/index.html" class="link">Articles</a></li><li><a href="Raspberry_Pi_FM_Radio_With_Buttons.html" class="link">Raspberry Pi FM radio transmitter with Buttons</a></li></ul><p><small>04-02-2015</small> | <small>Remy van Elst</small></p><div class='ad'>
                            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <!-- voorartikel -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:728px;height:90px"
                                 data-ad-client="ca-pub-7993642564731324"
                                 data-ad-slot="6172324376"></ins>
                            <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        </div><br><div id="toc"><h3>Table of Contents</h3></div><hr><div id="contents"><p><img src="https://raymii.org/s/inc/img/Pi_FM_1.png" alt="PiFM 1"></p>

<p>The <a href="http://www.icrobotics.co.uk/wiki/index.php/Turning_the_Raspberry_Pi_Into_an_FM_Transmitter">PiFM</a> project allows you to use a Raspberry Pi to send out a WAV file on the FM band. </p>

<p>This is awesome because every normal radio then can receive your music/podcast without expensive (sonos) equipment. It also allows you to listen in any car without the need for a radio that handles USB or Bluetooth.</p>

<p>I&#39;ve used a <a href="https://revspace.nl/Lasercutter">lasercutter</a> to craft a new top plate for my Pi which has room for three buttons. These are hooked up to a python script which allows me to start and stop the transmission, and skip or go back songs. It also allows me to shut down the Pi instead of just pulling the power cable.</p>

<p>If you like this tutorial and want to support my website, use this link to order a Digital Ocean VPS. You will get $10 free credit, which is equal to a free VPS for two months: <a href="https://www.digitalocean.com/?refcode=7435ae6b8212">https://www.digitalocean.com/?refcode=7435ae6b8212</a>   </p>

<p>Please do note that transmitting radio like this might be restricted in your country. In The Netherlands this setup (on FM bands 87,5 to 108 MHz) forbidden because it has too much transmission power. Transmitting on those frequencies is allowed if your transmittor has a maximum capacity of 50nW, and this setup has way more than that. <a href="http://www.agentschaptelecom.nl/gsearch/vergunningsvrije%2Bradiotoepassingen">Source: Agentschap Telecom</a>.</p>

<h3>Video</h3>

<p>A small demo, shot with a phone and an Android app for lack of better equipment:</p>

<iframe width="420" height="315" src="https://www.youtube.com/embed/QZFda0hv-ZE" frameborder="0" allowfullscreen></iframe>

<h3>The Case</h3>

<p><img src="https://raymii.org/s/inc/img/Short_Crust.jpg" alt="Short Crust"></p>

<p>The base of my case is a <a href="http://shortcrust.net/">Short Crust</a> case for the Model B. I initially bought this case because it reroutes the USB power to the front of the Pi. I mostly used it as a server back then, so having a power and a network cable at one side of the device is quite nice. The case also looks beautifull. I bought my case at <a href="https://www.pi-supply.com/">Pi Supply</a>.</p>

<p>Initially I wanted to use a 3D printer to make a case because I <a href="https://raymii.org/s/articles/3D_modelling_a_real_world_object_in_OpenSCAD.html">have some experience with that</a>. My hackerspace, <a href="https://revspace.nl">Revspace</a> has a <a href="https://revspace.nl/Lasercutter">Lasercutter</a> and I&#39;d never used that before. </p>

<p><img src="https://raymii.org/s/inc/img/Lasercutter.jpg" alt="Lasercutter"></p>

<p>I decided to replace the default top plate on the Short Crust with my own PMMA version which should have place for the three buttons and easy access to the GPIO. I don&#39;t find a flat ribbon cable easy access. After receiving the instructions and doing a few test cuts in plywood I fired up  Inkscape and found myself a good ruler. I&#39;d also never used Inkscape before but that is quite easy to figure out after some fiddling around.</p>

<p>The SVG file of the top case can be downloaded <a href="https://raymii.org/s/inc/img/Pi_Crust_Laser.svg">here</a>. It was cut at power 60% and speed 1.5. Below is a PNG version of the SVG:</p>

<p><img src="https://raymii.org/s/inc/img/Pi_Crust_Laser.png" alt="Top Plate"></p>

<p>My first attempts were not that great. Some measures were gambled the first time, as you can see in the below picture.</p>

<p><img src="https://raymii.org/s/inc/img/Pi_FM_4.png" alt="Compare"></p>

<ul>
<li>A: the rounding on the corners was way off</li>
<li>B: the big access point to the GPIO pins was in the wrong spot</li>
</ul>

<p>The holes for the screws were also a gamble, but, that was a lucky one, the are in exactly the correct spot. The button holes were measured up and since it are three standard <a href="https://www.google.nl/search?q=R13-57&amp;rct=j">R13-57</a> buttons that was easy. </p>

<p>After two attempts and correct measurements I succeeded in printing the correct top plate. It also has my website logo in it, the resistor symbol. That is just a nice touch.</p>

<h3>The Buttons</h3>

<p><img src="https://raymii.org/s/inc/img/R13-57.jpg" alt="R13-57" width="320" height="240"></p>

<p>I used three R13-57 push buttons for the input. They have wires soldered on to them and a few pieces of electrical tape so that they do not short the Pi. There is little space in the case. </p>

<p>The buttons are wired up to GPIO pin 18, 23 and 24 (and ground of course). I&#39;ve used the built in Raspberry Pi Pull Up resistor. If you are using another board of some kind please check if there is a pull up/down resistor built in, otherwise you need to place one in between the button and your GPIO pin, you will get drifting otherwise.</p>

<p><img src="https://raymii.org/s/inc/img/Pi_FM_2.png" alt="PiFM 2"></p>

<h3>The Python Script</h3>

<p>You can find the <a href="https://github.com/RaymiiOrg/rasplayer-fm">Python script in my github</a>. It is inspired by the <a href="https://github.com/Make-Magazine/PirateRadio">Pirate Radio</a> script frome Make Magazine.</p>

<p>The only part used from that script is the config and the ffmpeg to pifm converting. That script has no concept of a global playlist so implementing start, stop and skip functions in it would be harder. </p>

<p>I&#39;ve used GPIO callbacks to handle the button input. The button functions are listed below, where bottom is where the network and USB ports are:</p>

<ul>
<li>Top button: Previous Song</li>
<li>Middle button: Stop / Start playing</li>
<li>Bottom button: Next song</li>
</ul>

<p>If you first press the Middle (Stop) button and then the Top (Previous) button the Raspberry Pi will shut itself down using the <code>shutdown -h now</code> command. After a few seconds you can safely disconnect the power of the Pi without corrupting your SD card.</p>

<p><img src="https://raymii.org/s/inc/img/Pi_FM_3.png" alt="PiFM 3"></p>

<h3>Setup Instructions</h3>

<ul>
<li>Wire up three buttons to GPIO pins 18, 23, 24 and ground.</li>
<li>Wire up a simple wire on GPIO pin 4 for the antenna.</li>
<li>Load up Raspbian on your SD card.</li>
<li>Install <code>ffmpeg</code> and <code>python3</code>.</li>
<li>Create a folder <code>/rasplayerfm/</code> and place all your music there.</li>
<li><p>Place a config file there:</p>

<pre><code># /rasplayerfm/rasplayerfm.conf
[rasplayerfm]
frequency = 101.0
shuffle = False
repeat_all = True
stereo_playback = True
music_dir = /rasplayerfm
</code></pre></li>
<li><p>Place the compiled <code>pifm</code> binary and the <code>RasplayerFM.py</code> script there as well.</p></li>
<li><p>Add the following to <code>/etc/rc.local</code> (above the <code>exit 0</code> line):</p>

<pre><code>/usr/bin/python3 /rasplayerfm/RasplayerFM.py &amp;
</code></pre></li>
<li><p>Mark the <code>/etc/rc.local</code> file as executable:</p>

<pre><code>chmod +x /etc/rc.local
</code></pre></li>
<li><p>Tune your FM radio to the frequency set in the config file.</p></li>
<li><p>Reboot the Pi.</p></li>
<li><p>Wait a few moments.</p></li>
<li><p>Enjoy.</p></li>
</ul>

<p>When you boot the Pi up it will automatically start playing on the set frequency. With the buttons you can start, stop and skip music as described above. </p>

<p>This was an interesting project for me because it upped my knowledge and experience with a Lasercutter, Inkscape, GPIO, soldering and Python programming with callbacks and external inputs.</p>

<p>All the code (plus SVG file) from this article is released under the GPLv3. The images are Creative Commons BY-NC-SA.</p>
</div><hr>Tags: <a href="../tags/backup.html" class="link">backup, </a><a href="../tags/debian.html" class="link">debian, </a><a href="../tags/fm.html" class="link">fm, </a><a href="../tags/ham.html" class="link">ham, </a><a href="../tags/lasercutter.html" class="link">lasercutter, </a><a href="../tags/pifm.html" class="link">pifm, </a><a href="../tags/pirate-radio.html" class="link">pirate-radio, </a><a href="../tags/pmma.html" class="link">pmma, </a><a href="../tags/raspberry-pi.html" class="link">raspberry-pi, </a><a href="../tags/revspace.html" class="link">revspace, </a><div class="footer">
                <hr>
                <p>Generated by <a href="/s/software/ingsoc.html">ingsoc</a> | 
                <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                <a href="/s/static/About.html">About</a><br />
                </div>
            </div>
        </div>
    </div>  
    </div>
    </div>
     
    <!-- Piwik --> 
    <script type="text/javascript">
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://hosted-oswa.org/piwik/" : "http://hosted-oswa.org/piwik/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
    </script><script type="text/javascript">
    try {
    var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
    piwikTracker.trackPageView();
    piwikTracker.enableLinkTracking();
    } catch( err ) {}
    </script><noscript><p><img src="http://hosted-oswa.org/piwik/piwik.php?idsite=1" style="border:0" alt="" /></p></noscript>
    <!-- End Piwik Tracking Code -->
    </body>
    </html>
    